import{_ as n,c as a,o as s,a as e}from"./app-BrW2q7b4.js";const p={},t=e(`<h1 id="package-json" tabindex="-1"><a class="header-anchor" href="#package-json"><span><a href="http://javascript.ruanyifeng.com/nodejs/packagejson.html#toc6" target="_blank" rel="noopener noreferrer">package.json</a></span></a></h1><p>可以使用<a href="https://github.com/antfu/ni" target="_blank" rel="noopener noreferrer">ni</a>包管理器，统一<a href="https://docs.npmjs.com/cli/v6/commands/npm" target="_blank" rel="noopener noreferrer">npm</a> · <a href="https://yarnpkg.com/" target="_blank" rel="noopener noreferrer">yarn</a> · <a href="https://pnpm.js.org/en/" target="_blank" rel="noopener noreferrer">pnpm</a> · <a href="https://bun.sh/" target="_blank" rel="noopener noreferrer">bun</a> 各类不同项目的包管理器的自动切换以及命令统一</p><h2 id="yarn" tabindex="-1"><a class="header-anchor" href="#yarn"><span><a href="https://juejin.im/post/5da9c6b0e51d4524d67486e2#heading-4" target="_blank" rel="noopener noreferrer">yarn</a></span></a></h2><ul><li>yarn 会将安装过的包缓存下来，这样再次安装相同包的时候，就不需要再去下载，而是直接从缓存文件中直接 copy 进来。 可以通过命令 yarn cache dir 查看 yarn 的全局缓存目录。我的缓存目录在 /Library/Caches/Yarn/v1 下。</li><li>yarn.lock 文件是在安装期间，由 Yarn 自动生成的，并且由 yarn 来管理，不应该手动去更改，更不应该删除 yarn.lock 文件，且要提交到版本控制系统中，以免因为不同机器安装的包版本不一致引发问题</li></ul><h2 id="依赖管理" tabindex="-1"><a class="header-anchor" href="#依赖管理"><span>依赖管理</span></a></h2><ul><li><p><code>peerDependency</code>： 从 npm 3.0 版开始，<code>peerDependencies</code>不再会默认安装了。一些常用的包会被添加在 b 包的 peerDependencies 里，比如 react、react-router 等，可以认为工作项目 a 中一定已经安装了这些指定版本的依赖，少数情况下才需要手动安装。</p></li><li><p><code>dependencies</code> ：是项目运行所依赖的包。</p></li><li><p><code>devDependencies</code> ：是开发阶段所需要的包</p></li><li><p><code>optionalDependencies</code>：如果有一些依赖包即使安装失败，项目仍然能够运行或者希望 npm 继续运行，就可以使用 optionalDependencies。另外 optionalDependencies 会覆盖 dependencies 中的同名依赖包，所以不要在两个地方都写</p></li><li><p><a href="https://laysent.com/til/2020-01-08_bundleddependencies" target="_blank" rel="noopener noreferrer">bundleDenpendencies</a>： 这些指定的包也将在发布的时候一并被打包。这样，当其他人使用这个包的时候，就可以直接使用打包在项目内的依赖，而不需要在通过包管理器去下载了。</p></li><li><p>应用开发时无需关注以下类型的依赖，不同类型的依赖在使用时并无区别，yarn时两者都需要安装，一般只区分dependencies与devDependencies作为项目开发规范</p></li><li><p>而开发库时，需要关注以上类型不同类型的dependencies，在安装库时有实际区分</p></li></ul><h3 id="安装包" tabindex="-1"><a class="header-anchor" href="#安装包"><span><a href="https://docs.npmjs.com/cli/v7/commands/npm-install" target="_blank" rel="noopener noreferrer">安装包</a></span></a></h3><p>可以从各种路径安装一个包，见以下命令</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token punctuation">(</span>with no args, <span class="token keyword">in</span> package <span class="token function">dir</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>@scope<span class="token operator">&gt;</span>/<span class="token punctuation">]</span><span class="token operator">&lt;</span>name<span class="token operator">&gt;</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>@scope<span class="token operator">&gt;</span>/<span class="token punctuation">]</span><span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>@<span class="token operator">&lt;</span>tag<span class="token operator">&gt;</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>@scope<span class="token operator">&gt;</span>/<span class="token punctuation">]</span><span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>@<span class="token operator">&lt;</span>version<span class="token operator">&gt;</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>@scope<span class="token operator">&gt;</span>/<span class="token punctuation">]</span><span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>@<span class="token operator">&lt;</span>version range<span class="token operator">&gt;</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token operator">&lt;</span>alias<span class="token operator">&gt;</span>@npm:<span class="token operator">&lt;</span>name<span class="token operator">&gt;</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token operator">&lt;</span>git-host<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>git-user<span class="token operator">&gt;</span>/<span class="token operator">&lt;</span>repo-name<span class="token operator">&gt;</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token operator">&lt;</span>git repo url<span class="token operator">&gt;</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token operator">&lt;</span>tarball file<span class="token operator">&gt;</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token operator">&lt;</span>tarball url<span class="token operator">&gt;</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token operator">&lt;</span>folder<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line">aliases: <span class="token function">npm</span> i, <span class="token function">npm</span> <span class="token function">add</span></span>
<span class="line">common options: <span class="token punctuation">[</span>-P<span class="token operator">|</span>--save-prod<span class="token operator">|</span>-D<span class="token operator">|</span>--save-dev<span class="token operator">|</span>-O<span class="token operator">|</span>--save-optional<span class="token operator">|</span>--save-peer<span class="token punctuation">]</span> <span class="token punctuation">[</span>-E<span class="token operator">|</span>--save-exact<span class="token punctuation">]</span> <span class="token punctuation">[</span>-B<span class="token operator">|</span>--save-bundle<span class="token punctuation">]</span> <span class="token punctuation">[</span>--no-save<span class="token punctuation">]</span> <span class="token punctuation">[</span>--dry-run<span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="锁定依赖版本" tabindex="-1"><a class="header-anchor" href="#锁定依赖版本"><span><a href="https://mp.weixin.qq.com/s/Qrzn3rLKfMI9V6diQ_7vBg" target="_blank" rel="noopener noreferrer">锁定依赖版本</a></span></a></h3><h4 id="lock-文件" tabindex="-1"><a class="header-anchor" href="#lock-文件"><span>lock 文件</span></a></h4><p>实际开发中，经常会因为各种依赖不一致而产生奇怪的问题，或者在某些场景下，我们不希望依赖被更新，建议在开发中使用 <code>package-lock.json</code>。</p><p>锁定依赖版本意味着在我们不手动执行更新的情况下，每次安装依赖都会安装固定版本。保证整个团队使用版本号一致的依赖。</p><p>每次安装固定版本，无需计算依赖版本范围，大部分场景下能大大加速依赖安装时间。</p><blockquote><p>使用 package-lock.json 要确保 npm 的版本在 5.6 以上，因为在 5.0 - 5.6 中间，对 package-lock.json 的处理逻辑进行过几次更新，5.6 版本后处理逻辑逐渐稳定。</p></blockquote><p>关于 <code>package-lock.json</code> 详细的结构，我们会在后面的章节进行解析。</p><h4 id="定期更新依赖" tabindex="-1"><a class="header-anchor" href="#定期更新依赖"><span>定期更新依赖</span></a></h4><p>我们的目的是保证团队中使用的依赖一致或者稳定，而不是永远不去更新这些依赖。实际开发场景下，我们虽然不需要每次都去安装新的版本，仍然需要定时去升级依赖版本，来让我们享受依赖包升级带来的问题修复、性能提升、新特性更新。</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/aDoYvepE5x0MbmLUkEwkhrI7KF9cHZTf1VH7ad5bwuJia8YvCUzGqiago5Uoic0Oomia2gpqMjibHoy8qDkicFUg3vvg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p><p>使用 <code>npm outdated</code> 可以帮助我们列出有哪些还没有升级到最新版本的依赖：</p><ul><li>黄色表示不符合我们指定的语意化版本范围 - 不需要升级</li><li>红色表示符合指定的语意化版本范围 - 需要升级</li></ul><p>执行 <code>npm update</code> 会升级所有的红色依赖。</p><h2 id="yarn-add-远程-git-协议" tabindex="-1"><a class="header-anchor" href="#yarn-add-远程-git-协议"><span><a href="https://stackoverflow.com/questions/31801271/what-are-the-supported-git-url-formats" target="_blank" rel="noopener noreferrer">yarn add 远程 git 协议</a></span></a></h2><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line">yarn add <span class="token operator">&lt;</span>git remote url<span class="token operator">&gt;</span> installs a <span class="token keyword">package</span> from a remote git repository<span class="token punctuation">.</span></span>
<span class="line">yarn add <span class="token operator">&lt;</span>git remote url<span class="token operator">&gt;</span>#<span class="token operator">&lt;</span>branch<span class="token operator">/</span>commit<span class="token operator">/</span>tag<span class="token operator">&gt;</span> installs a <span class="token keyword">package</span> from a remote git repository at specific git branch<span class="token punctuation">,</span> git commit or git tag<span class="token punctuation">.</span></span>
<span class="line">yarn add https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>my<span class="token operator">-</span>project<span class="token punctuation">.</span>org<span class="token operator">/</span><span class="token keyword">package</span><span class="token punctuation">.</span>tgz installs a <span class="token keyword">package</span> from a remote gzipped tarball<span class="token punctuation">.</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Here are some examples:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line">yarn add https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>fancyapps<span class="token operator">/</span>fancybox <span class="token punctuation">[</span>remote url<span class="token punctuation">]</span></span>
<span class="line">yarn add ssh<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>fancyapps<span class="token operator">/</span>fancybox#<span class="token number">3.0</span>  <span class="token punctuation">[</span>branch<span class="token punctuation">]</span></span>
<span class="line">yarn add https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>fancyapps<span class="token operator">/</span>fancybox#5cda5b529ce3fb6c167a55d42ee5a316e921d95f <span class="token punctuation">[</span>commit<span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>(Note: Fancybox v2.6.1 isn&#39;t available in the Git version.)</em></p><p>To support both npm and yarn, you can use the git+url syntax:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">git+https://github.com/owner/package.git<span class="token comment">#commithashortagorbranch</span></span>
<span class="line">git+ssh://github.com/owner/package.git<span class="token comment">#commithashortagorbranch</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol><li><code>yarn add package-name</code></li><li><code>yarn add file:/path/to/local/folder</code></li><li><code>yarn add file:/path/to/local/tarball.tgz</code> installs a package from a gzipped tarball which could be used to share a package before publishing it.</li><li><code>yarn add link:/path/to/local/folder</code></li><li><code>yarn add &lt;git remote url&gt;</code> installs a package from a remote git repository.</li><li><code>yarn add &lt;git remote url&gt;#&lt;branch/commit/tag&gt;</code> installs a package from a remote git repository at specific git branch, git commit or git tag.</li><li><code>yarn add https://my-project.org/package.tgz</code> installs a package from a remote gzipped tarball.</li></ol><h2 id="npm-scripts-使用指南" tabindex="-1"><a class="header-anchor" href="#npm-scripts-使用指南"><span><a href="http://www.ruanyifeng.com/blog/2016/10/npm_scripts.html" target="_blank" rel="noopener noreferrer">npm scripts 使用指南</a></span></a></h2><p>script 脚本传参 -- arguments</p><p>而<code>npm restart</code>是一个复合命令,实际上会执行三个脚本命令：<code>stop</code>、<code>restart</code>、<code>start</code>。其分别有自己的pre和post命令</p><h2 id="变量" tabindex="-1"><a class="header-anchor" href="#变量"><span>变量</span></a></h2><p>首先，通过<code>npm_package_</code>前缀，npm 脚本可以拿到<code>package.json</code>里面的字段</p><p><a href="https://mp.weixin.qq.com/s/I4hhrgI3-Y18HD8zw_9g9w" target="_blank" rel="noopener noreferrer">调试指南</a></p><p>除了npm link ，本地测试其实可以直接修改使用模块的引用路径为本地的绝对路径，或者用<a href="https://juejin.cn/post/7033400734746066957" target="_blank" rel="noopener noreferrer">yalc</a>替换</p><ul><li>使用yalc可以解决依赖解析、文件系统之间的符号链接互操作性等问题</li></ul><h2 id="npx" tabindex="-1"><a class="header-anchor" href="#npx"><span>npx</span></a></h2><p>它会自动查找当前依赖包中的二进制可执行文件，如果找不到，就会去 PATH 里找。如果依然找不到，就会帮你安装，解决一次性命令的使用问题</p><ul><li>用于临时使用 npm 模块，而不需要全局安装</li><li><code>npx --no-install http-server</code></li><li><code>npx --ignore-existing create-react-app my-react-app</code></li><li><code>npx https://gist.github.com/zkat/4bc19503fe9e9309e2bfaa2c58074d32</code> 执行 Gist 代码</li><li>在以往中，我们在 node 项目中要执行一个脚本，需要将它在 scripts 中声明，用了 npx 以后呢，你不需要在 scripts 中声明了，就可以直接敲键盘了（npx 开头，然后接你要执行的内容）：</li></ul><h2 id="版本管理" tabindex="-1"><a class="header-anchor" href="#版本管理"><span><a href="https://mp.weixin.qq.com/s/Qrzn3rLKfMI9V6diQ_7vBg" target="_blank" rel="noopener noreferrer">版本管理</a></span></a></h2><table><thead><tr><th>命令</th><th>结果</th></tr></thead><tbody><tr><td>npm version patch</td><td>v1.0.1</td></tr><tr><td>npm version major</td><td>v1.1.0</td></tr><tr><td>npm version minor</td><td>v2.0.0</td></tr></tbody></table><p>minor.major.patch</p><h3 id="npm-版本语义化" tabindex="-1"><a class="header-anchor" href="#npm-版本语义化"><span><a href="https://www.jianshu.com/p/a7490344044f" target="_blank" rel="noopener noreferrer">npm 版本语义化</a></span></a></h3><p>npm 版本 a-b-c</p><ul><li>a 是大版本，a 不同可能会有兼容性问题</li><li>b 是 feature</li><li>c 是 fix</li></ul><p>MAJOR.MINOR.PATCH</p><p>alpha - 开发 （内测） --&gt; beta - 测试 （公测）--&gt; rc - 灰度 （候选）</p><h4 id="升级版本号的规则主要有三个" tabindex="-1"><a class="header-anchor" href="#升级版本号的规则主要有三个"><span>升级版本号的规则主要有三个</span></a></h4><ul><li><p>主版本号：当你做了不兼容的 API 修改，为 0 时，处于开发阶段</p></li><li><p>次版本号：当你做了向下兼容的功能性新增，不一定向下兼容</p></li><li><p>修订号：当你做了向下兼容的问题修正</p></li><li><p>先行版本号 ：正式版本之前的版本，用于发布一个新的不兼容的主版本号</p></li><li><p>版本编译信息 在先行版本号后加上“+”号的标识符，</p></li><li><p>^表示在同一个<strong>主</strong>版本号中，大于等于指定版本号，也即升级 minor 次版本号</p></li><li><p>~表示在同一<strong>主次</strong>版本号中，大于等于指定版本号，也即升级 patch 修订版本号</p></li></ul><h3 id="查看-npm-包版本信息" tabindex="-1"><a class="header-anchor" href="#查看-npm-包版本信息"><span>查看 npm 包版本信息</span></a></h3><h4 id="原理" tabindex="-1"><a class="header-anchor" href="#原理"><span>原理</span></a></h4><p><code>npm update</code>命令怎么知道每个模块的最新版本呢？</p><ul><li>npm 模块仓库提供了一个查询服务，叫做 registry 。以 npmjs.org 为例，它的查询服务网址是 <a href="https://registry.npmjs.org/" target="_blank" rel="noopener noreferrer"><code>https://registry.npmjs.org/</code></a> ，这个网址后面跟上模块名，就会得到一个 JSON 对象，里面是该模块所有版本的信息。比如，访问 <a href="https://registry.npmjs.org/react" target="_blank" rel="noopener noreferrer"><code>https://registry.npmjs.org/react</code></a>，就会看到 react 模块所有版本的信息。</li></ul><h4 id="命令操作" tabindex="-1"><a class="header-anchor" href="#命令操作"><span>命令操作</span></a></h4><p>你可以执行 <code>npm view package version</code> 查看某个 <code>package</code> 的最新版本</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">npm</span> view react</span>
<span class="line"></span>
<span class="line"><span class="token comment"># npm view 的别名</span></span>
<span class="line"><span class="token function">npm</span> info react</span>
<span class="line"><span class="token function">npm</span> show react</span>
<span class="line"><span class="token function">npm</span> <span class="token function">v</span> react</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看包的所有版本</span></span>
<span class="line"><span class="token function">npm</span> view react versions</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看当前仓库依赖树上所有包的版本信息</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">ls</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://img-blog.csdnimg.cn/20190914141436350.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTExMjcwMTk=,size_16,color_FFFFFF,t_70" alt="npm更新模块命令_天马3798-CSDN博客_npm 更新模块"></p><h4 id="dist-tag" tabindex="-1"><a class="header-anchor" href="#dist-tag"><span><a href="https://www.jianshu.com/p/91902bae5572" target="_blank" rel="noopener noreferrer">dist-tag</a></span></a></h4><ul><li><p>标签可用于提供别名而不是版本号。</p></li><li><p>例如，一个项目可能会选择有发展的多个数据流，并使用不同的标签为每个数据流，如 stable，beta，dev，canary。</p></li><li><p>默认，npm 使用 latest 来标识软件包的当前版本，并且 <code>npm install &lt;pkg&gt;</code>（无任何 <code>@&lt;version&gt;</code>或 <code>@&lt;tag&gt;</code> 指定符）安装该 latest 标签。</p></li><li><p>一般项目仅将 latest 标记用于稳定的发行版本，而将其他标记用于不稳定的版本，例如预发行。</p></li><li><p>next ：一些项目使用该标签来标识即将发布的版本。</p></li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 使用</span></span>
<span class="line"><span class="token function">npm</span> dist-tag <span class="token function">ls</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>pkg<span class="token operator">&gt;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token function">npm</span> dist-tag <span class="token function">add</span> <span class="token operator">&lt;</span>pkg<span class="token operator">&gt;</span>@<span class="token operator">&lt;</span>version<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>tag<span class="token operator">&gt;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token function">npm</span> dist-tag <span class="token function">rm</span> <span class="token operator">&lt;</span>pkg<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>tag<span class="token operator">&gt;</span></span>
<span class="line"><span class="token function">npm</span> dist-tag <span class="token function">ls</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>pkg<span class="token operator">&gt;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token comment"># 安装依赖项时，可以指定首选的标记版本：</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">--tag</span> <span class="token operator">&lt;</span>tag<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 发布一个带tag的版本，默认是latest,以下命令中tag是next</span></span>
<span class="line"><span class="token function">npm</span> publish <span class="token parameter variable">--tag</span> next</span>
<span class="line"><span class="token comment"># 可以通过以下命令安装所属next的最新版本</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> my-package@next</span>
<span class="line"><span class="token comment"># 修改tagName</span></span>
<span class="line"><span class="token function">npm</span> dist-tag <span class="token function">add</span> my-package@version next</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="npm-源" tabindex="-1"><a class="header-anchor" href="#npm-源"><span>npm 源</span></a></h2><p>以下配置源的方法优先级从高到低</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 为单包指定特定源</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">-g</span> cnpm <span class="token parameter variable">--registry</span><span class="token operator">=</span>https://registry.npm.taobao.org</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 项目中创建配置文件.npmrc</span></span>
<span class="line">@scopename:registry<span class="token operator">=</span><span class="token operator">&lt;</span>registry url<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看配置的源使用 npm config get registry &lt;registry url&gt;</span></span>
<span class="line"><span class="token function">npm</span> config <span class="token builtin class-name">set</span> registry <span class="token operator">&lt;</span>registry url<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="npmrc" tabindex="-1"><a class="header-anchor" href="#npmrc"><span>npmrc</span></a></h3><p>通过项目中配置 npmrc，我们可以方便地在工程跟目录创建一个 .npmrc 文件来共享需要在团队间共享的 npm 运行相关配置。比如如果我们在公司内网环境下需通过代理才可访问 registry.npmjs.org 源，或需访问内网的 registry, 就可以在工作项目下新增 .npmrc 文件并提交代码库。</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">proxy <span class="token operator">=</span> http://proxy.example.com/</span>
<span class="line">https-proxy <span class="token operator">=</span> http://proxy.example.com/</span>
<span class="line">registry <span class="token operator">=</span> http://registry.example.com/</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="https://segmentfault.com/a/1190000017419993" target="_blank" rel="noopener noreferrer">nrm 切换源</a></p><h2 id="bin-字段与-script-字段" tabindex="-1"><a class="header-anchor" href="#bin-字段与-script-字段"><span><a href="http://www.ruanyifeng.com/blog/2016/10/npm_scripts.html" target="_blank" rel="noopener noreferrer">bin 字段与 script 字段</a></span></a></h2><p>npm 脚本的原理非常简单。每当执行<code>npm run</code>，就会自动新建一个 Shell，在这个 Shell 里面执行指定的脚本命令。因此，只要是 Shell（一般是 Bash）可以运行的命令，就可以写在 npm 脚本里面。</p><p>比较特别的是，<code>npm run</code>新建的这个 Shell，会将当前目录的<code>node_modules/.bin</code>子目录加入<code>PATH</code>变量，执行结束后，再将<code>PATH</code>变量恢复原样。</p><p>这意味着，当前目录的<code>node_modules/.bin</code>子目录里面的所有脚本，都可以直接用脚本名调用，而不必加上路径。比如，当前项目的依赖里面有 Mocha，只要直接写<code>mocha test</code>就可以了。</p><h4 id="本地调试命令别名" tabindex="-1"><a class="header-anchor" href="#本地调试命令别名"><span>本地调试命令别名</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token string-property property">&quot;bin&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string-property property">&quot;myapp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;node index&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>以上配置后，可以在项目目录下运行 myapp，相当于 node index 命令。相当于一个命令别名</p><h4 id="指定各个内部命令对应的可执行文件" tabindex="-1"><a class="header-anchor" href="#指定各个内部命令对应的可执行文件"><span>指定各个内部命令对应的可执行文件</span></a></h4><p>bin 项用来指定各个内部命令对应的可执行文件的位置。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token string-property property">&quot;bin&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token string-property property">&quot;someTool&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./bin/someTool.js&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面代码指定，someTool 命令对应的可执行文件为 bin 子目录下的 someTool.js。</p><p>在上面的例子中，someTool.js 会建立符号链接 node_modules/.bin/someTool。</p><p>由于 node_modules/.bin/目录会在运行时加入系统的 PATH 变量，因此在运行 npm 时，就可以不带路径，直接通过命令来调用这些脚本。</p><p>因此，像下面这样的写法可以采用简写。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token literal-property property">scripts</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">start</span><span class="token operator">:</span> <span class="token string">&#39;./node_modules/bin/someTool.js build&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 简写为</span></span>
<span class="line"></span>
<span class="line"><span class="token literal-property property">scripts</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">start</span><span class="token operator">:</span> <span class="token string">&#39;someTool build&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在安装第三方带有 bin 字段的 npm，那可执行文件会被链接到当前项目的./node_modules/.bin 中，在本项目中，就可以很方便地利用 npm 执行脚本（package.json 文件中 scripts 可以直接执行：&#39;node node_modules/.bin/myapp&#39;）；</p><ol><li>如果是全局安装，npm 将会使用符号链接把这些文件链接到/usr/local/bin/（MAC），那么各个地方都可以使用指定命令了</li><li>如果是本地安装，会链接到./node_modules/.bin/。 <ul><li>所有 node_modules/.bin/目录下的命令，都可以用 npm run [命令]的格式运行。在</li><li>命令行下，键入 npm run，然后按 tab 键，就会显示所有可以使用的命令。</li></ul></li></ol><h2 id="export-字段" tabindex="-1"><a class="header-anchor" href="#export-字段"><span><a href="https://www.baobangdong.cn/node.js-package.json-field-definitions/" target="_blank" rel="noopener noreferrer">export 字段</a></span></a></h2><p>他最大的一个特性就是 <strong>条件导出（Conditional Exports）</strong>，当该 package 被导入时，能够判断被导入时的模块环境，从而执行不同的文件，简而言之就是，我们如果使用 <code>import</code> 命令，入口会加载 ECMAScript Modules 文件，如果使用 <code>require</code> 命令，入口则加载 CommonJS Modules 文件。</p><h2 id="pkg-中-module-字段" tabindex="-1"><a class="header-anchor" href="#pkg-中-module-字段"><span><a href="https://zhuanlan.zhihu.com/p/34164963" target="_blank" rel="noopener noreferrer">pkg 中 module 字段</a></span></a></h2><p>module 字段用来标注库中 esm 版本的入口，若库中包含此字段，则表示支持 treeShaking</p><h2 id="unpkg-和-cdn-js" tabindex="-1"><a class="header-anchor" href="#unpkg-和-cdn-js"><span><a href="https://segmentfault.com/a/1190000040875211" target="_blank" rel="noopener noreferrer">unpkg 和 cdn.js</a></span></a></h2><ul><li><a href="https://developer.aliyun.com/article/592213" target="_blank" rel="noopener noreferrer">unpkg</a> 是一个快速的全球内容分发网络，适用于 npm 上的所有内容。使用它可以使用以下 URL 快速轻松地从任何包加载任何文件：<code>unpkg.com/:package@:version/:file</code></li><li>cdnjs 提供了一个简单的 API，允许任何人快速查询 CDN 上的资源,<code>https://api.cdnjs.com/libraries?search=jquery</code>，返回一个<a href="https://image-static.segmentfault.com/803/289/803289998-33093935360af500_fix732" target="_blank" rel="noopener noreferrer">以 jquery 为搜索条件的包 cdn 列表</a>，这是一个 get 请求，数组的第一项为名称/功能最相近的资源的最新 CDN 资源地址</li></ul><h2 id="package-json-非官方字段集合" tabindex="-1"><a class="header-anchor" href="#package-json-非官方字段集合"><span><a href="https://segmentfault.com/a/1190000016365409" target="_blank" rel="noopener noreferrer">package.json 非官方字段集合</a></span></a></h2><h2 id="其他" tabindex="-1"><a class="header-anchor" href="#其他"><span>其他</span></a></h2><ul><li><a href="https://juejin.cn/post/6962554654643191815" target="_blank" rel="noopener noreferrer">手把手教你使用 patch-package 给 npm 包打补丁</a></li></ul>`,96),l=[t];function o(r,i){return s(),a("div",null,l)}const d=n(p,[["render",o],["__file","package.json.html.vue"]]),u=JSON.parse('{"path":"/%E5%B7%A5%E7%A8%8B%E5%8C%96/package.json.html","title":"package.json","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"yarn","slug":"yarn","link":"#yarn","children":[]},{"level":2,"title":"依赖管理","slug":"依赖管理","link":"#依赖管理","children":[{"level":3,"title":"安装包","slug":"安装包","link":"#安装包","children":[]},{"level":3,"title":"锁定依赖版本","slug":"锁定依赖版本","link":"#锁定依赖版本","children":[]}]},{"level":2,"title":"yarn add 远程 git 协议","slug":"yarn-add-远程-git-协议","link":"#yarn-add-远程-git-协议","children":[]},{"level":2,"title":"npm scripts 使用指南","slug":"npm-scripts-使用指南","link":"#npm-scripts-使用指南","children":[]},{"level":2,"title":"变量","slug":"变量","link":"#变量","children":[]},{"level":2,"title":"npx","slug":"npx","link":"#npx","children":[]},{"level":2,"title":"版本管理","slug":"版本管理","link":"#版本管理","children":[{"level":3,"title":"npm 版本语义化","slug":"npm-版本语义化","link":"#npm-版本语义化","children":[]},{"level":3,"title":"查看 npm 包版本信息","slug":"查看-npm-包版本信息","link":"#查看-npm-包版本信息","children":[]}]},{"level":2,"title":"npm 源","slug":"npm-源","link":"#npm-源","children":[{"level":3,"title":"npmrc","slug":"npmrc","link":"#npmrc","children":[]}]},{"level":2,"title":"bin 字段与 script 字段","slug":"bin-字段与-script-字段","link":"#bin-字段与-script-字段","children":[]},{"level":2,"title":"export 字段","slug":"export-字段","link":"#export-字段","children":[]},{"level":2,"title":"pkg 中 module 字段","slug":"pkg-中-module-字段","link":"#pkg-中-module-字段","children":[]},{"level":2,"title":"unpkg 和 cdn.js","slug":"unpkg-和-cdn-js","link":"#unpkg-和-cdn-js","children":[]},{"level":2,"title":"package.json 非官方字段集合","slug":"package-json-非官方字段集合","link":"#package-json-非官方字段集合","children":[]},{"level":2,"title":"其他","slug":"其他","link":"#其他","children":[]}],"git":{"updatedTime":1717649313000,"contributors":[{"name":"Liu Jia","email":"41950983+liujia6@users.noreply.github.com","commits":1}]},"filePathRelative":"工程化/package.json.md"}');export{d as comp,u as data};
