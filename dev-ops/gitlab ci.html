<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gitlab-CI | æ¸¸ç¦» ã® Blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.1cdd1db5.css" as="style"><link rel="preload" href="/assets/js/app.301264ef.js" as="script"><link rel="preload" href="/assets/js/2.491aa157.js" as="script"><link rel="preload" href="/assets/js/33.3096cd30.js" as="script"><link rel="prefetch" href="/assets/js/10.c14c6624.js"><link rel="prefetch" href="/assets/js/11.a9937c4e.js"><link rel="prefetch" href="/assets/js/12.b046b473.js"><link rel="prefetch" href="/assets/js/13.01aa47ff.js"><link rel="prefetch" href="/assets/js/14.f42daf23.js"><link rel="prefetch" href="/assets/js/15.fb6a03fc.js"><link rel="prefetch" href="/assets/js/16.3d6029c1.js"><link rel="prefetch" href="/assets/js/17.e7fd4a45.js"><link rel="prefetch" href="/assets/js/18.2eee2a30.js"><link rel="prefetch" href="/assets/js/19.c7a805c8.js"><link rel="prefetch" href="/assets/js/20.6ec04b81.js"><link rel="prefetch" href="/assets/js/21.d6a9c37a.js"><link rel="prefetch" href="/assets/js/22.d54975c6.js"><link rel="prefetch" href="/assets/js/23.dd01fe58.js"><link rel="prefetch" href="/assets/js/24.5b080a00.js"><link rel="prefetch" href="/assets/js/25.3e3a8a4d.js"><link rel="prefetch" href="/assets/js/26.530f08ad.js"><link rel="prefetch" href="/assets/js/27.4ff6770f.js"><link rel="prefetch" href="/assets/js/28.4772ab22.js"><link rel="prefetch" href="/assets/js/29.59c92581.js"><link rel="prefetch" href="/assets/js/3.2a78adba.js"><link rel="prefetch" href="/assets/js/30.8945c40e.js"><link rel="prefetch" href="/assets/js/31.71ea1936.js"><link rel="prefetch" href="/assets/js/32.242631cf.js"><link rel="prefetch" href="/assets/js/34.65f27a2b.js"><link rel="prefetch" href="/assets/js/35.8a5e22fe.js"><link rel="prefetch" href="/assets/js/36.b8444b82.js"><link rel="prefetch" href="/assets/js/37.07333cdf.js"><link rel="prefetch" href="/assets/js/38.c9340582.js"><link rel="prefetch" href="/assets/js/39.86b27506.js"><link rel="prefetch" href="/assets/js/4.6c7e408b.js"><link rel="prefetch" href="/assets/js/40.3e8e0e91.js"><link rel="prefetch" href="/assets/js/41.4abf36b5.js"><link rel="prefetch" href="/assets/js/42.b93937ca.js"><link rel="prefetch" href="/assets/js/43.599a58a3.js"><link rel="prefetch" href="/assets/js/44.58c0ac23.js"><link rel="prefetch" href="/assets/js/45.a007e26f.js"><link rel="prefetch" href="/assets/js/46.9aebcd42.js"><link rel="prefetch" href="/assets/js/47.ac13be33.js"><link rel="prefetch" href="/assets/js/48.34e99078.js"><link rel="prefetch" href="/assets/js/49.195b0aef.js"><link rel="prefetch" href="/assets/js/5.82c6f654.js"><link rel="prefetch" href="/assets/js/50.964a51b7.js"><link rel="prefetch" href="/assets/js/51.b0b85444.js"><link rel="prefetch" href="/assets/js/52.755194bb.js"><link rel="prefetch" href="/assets/js/53.bd98d30b.js"><link rel="prefetch" href="/assets/js/54.51fa13df.js"><link rel="prefetch" href="/assets/js/55.3b27f82c.js"><link rel="prefetch" href="/assets/js/56.2d5f09af.js"><link rel="prefetch" href="/assets/js/57.59e5bf64.js"><link rel="prefetch" href="/assets/js/58.4da215bb.js"><link rel="prefetch" href="/assets/js/59.f0dd1160.js"><link rel="prefetch" href="/assets/js/6.5245781e.js"><link rel="prefetch" href="/assets/js/60.8a3a51dc.js"><link rel="prefetch" href="/assets/js/61.2d221c84.js"><link rel="prefetch" href="/assets/js/62.1efabc55.js"><link rel="prefetch" href="/assets/js/63.fad6ede3.js"><link rel="prefetch" href="/assets/js/64.16603306.js"><link rel="prefetch" href="/assets/js/65.fa49138c.js"><link rel="prefetch" href="/assets/js/66.881a3bb5.js"><link rel="prefetch" href="/assets/js/67.25cbb4cf.js"><link rel="prefetch" href="/assets/js/68.117eca53.js"><link rel="prefetch" href="/assets/js/69.053855dc.js"><link rel="prefetch" href="/assets/js/7.fc1bdbb6.js"><link rel="prefetch" href="/assets/js/70.7721e7e9.js"><link rel="prefetch" href="/assets/js/71.29a557ad.js"><link rel="prefetch" href="/assets/js/72.1a6f90ae.js"><link rel="prefetch" href="/assets/js/73.913d468a.js"><link rel="prefetch" href="/assets/js/74.96968d72.js"><link rel="prefetch" href="/assets/js/75.01b38a33.js"><link rel="prefetch" href="/assets/js/76.f82ae778.js"><link rel="prefetch" href="/assets/js/77.68514817.js"><link rel="prefetch" href="/assets/js/78.56b87e13.js"><link rel="prefetch" href="/assets/js/79.9ac9d757.js"><link rel="prefetch" href="/assets/js/8.f060be44.js"><link rel="prefetch" href="/assets/js/80.6090f235.js"><link rel="prefetch" href="/assets/js/81.7de2f01b.js"><link rel="prefetch" href="/assets/js/82.1b7be951.js"><link rel="prefetch" href="/assets/js/83.1104bfb5.js"><link rel="prefetch" href="/assets/js/84.7e0dbb84.js"><link rel="prefetch" href="/assets/js/85.abb461ec.js"><link rel="prefetch" href="/assets/js/86.2e77efbc.js"><link rel="prefetch" href="/assets/js/87.b93727f5.js"><link rel="prefetch" href="/assets/js/88.b554117b.js"><link rel="prefetch" href="/assets/js/89.c1306298.js"><link rel="prefetch" href="/assets/js/9.18126abf.js"><link rel="prefetch" href="/assets/js/90.328f05cd.js"><link rel="prefetch" href="/assets/js/91.8008e0b0.js"><link rel="prefetch" href="/assets/js/92.8b4dca37.js"><link rel="prefetch" href="/assets/js/93.9f7d7273.js"><link rel="prefetch" href="/assets/js/94.176890d0.js"><link rel="prefetch" href="/assets/js/95.a69dbea6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1cdd1db5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">æ¸¸ç¦» ã® Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/vuejs/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/vuejs/vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Dev Ops</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev-ops/ansible.html" class="sidebar-link">ansible</a></li><li><a href="/dev-ops/docker.html" class="sidebar-link">Docker</a></li><li><a href="/dev-ops/gitlab ci.html" class="active sidebar-link">Gitlab-CI</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev-ops/gitlab ci.html#gitlab-ci" class="sidebar-link">Gitlab-CI</a></li><li class="sidebar-sub-header"><a href="/dev-ops/gitlab ci.html#ä»‹ç»" class="sidebar-link">ä»‹ç»</a></li><li class="sidebar-sub-header"><a href="/dev-ops/gitlab ci.html#gitlab-runner" class="sidebar-link">gitlab-runner</a></li><li class="sidebar-sub-header"><a href="/dev-ops/gitlab ci.html#stages" class="sidebar-link">stages</a></li><li class="sidebar-sub-header"><a href="/dev-ops/gitlab ci.html#å‚è€ƒ" class="sidebar-link">å‚è€ƒ</a></li></ul></li><li><a href="/dev-ops/gitlab-ciè¸©å‘.html" class="sidebar-link">Gitlab-ci è¸©å‘</a></li><li><a href="/dev-ops/linuxæ€»ç»“.html" class="sidebar-link">linux æ€»ç»“</a></li><li><a href="/dev-ops/nginx.html" class="sidebar-link">nginx</a></li><li><a href="/dev-ops/ssh.html" class="sidebar-link">ssh</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å·¥ç¨‹åŒ–</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ç®—æ³•</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ç½‘ç»œ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>è®¡ç®—æœºåŸºç¡€</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ç¼–ç¨‹</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å…¶ä»–</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="gitlab-ci"><a href="#gitlab-ci" class="header-anchor">#</a> Gitlab-CI</h2> <h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="header-anchor">#</a> ä»‹ç»</h2> <p>Gitlab CI/CD æ˜¯ä¸€æ¬¾ç”¨äº<a href="https://github.com/ascoders/weekly/blob/v2/101.%E7%B2%BE%E8%AF%BB%E3%80%8A%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%20vs%20%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%98%20vs%20%E6%8C%81%E7%BB%AD%E9%83%A8%E7%BD%B2%E3%80%8B.md" target="_blank" rel="noopener noreferrer">æŒç»­é›†æˆï¼ˆCIï¼‰ï¼ŒæŒç»­äº¤ä»˜ï¼ˆCDï¼‰<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>çš„å·¥å…·ï¼Œç›¸ä¼¼çš„å·¥å…·æœ‰ Jenkinsã€Travis CIã€GoCD ç­‰ã€‚</p> <ul><li>CI å³æŒç»­é›†æˆï¼ŒContinuous Integrationï¼Œç›®æ ‡ï¼šæŒç»­é›†æˆï¼ŒæŒç»­æµ‹è¯•ï¼ˆä¿è¯ä»£ç è´¨é‡ï¼‰</li> <li>CD å³æŒç»­äº¤ä»˜ï¼Œå³ Continuous Deliveryï¼Œç›®æ ‡:Â  æŒç»­éƒ¨ç½²ï¼ˆè‡ªåŠ¨å‘å¸ƒç‰ˆæœ¬ï¼Œä¾›ç”¨æˆ·ä½¿ç”¨)ã€‚</li> <li>ä» GitLab 8.0 å¼€å§‹ï¼ŒGitLab CI å°±å·²ç»é›†æˆåœ¨ GitLab ä¸­ï¼Œæˆ‘ä»¬åªè¦åœ¨é¡¹ç›®ä¸­æ·»åŠ ä¸€ä¸ª .gitlab-ci.yml æ–‡ä»¶ï¼Œç„¶åæ·»åŠ ä¸€ä¸ª Runnerï¼Œå³å¯è¿›è¡ŒæŒç»­é›†æˆã€‚</li> <li>.gitlab-ci.yml æ–‡ä»¶ä½¿ç”¨ yaml è¯­æ³•ï¼Œ<a href="http://www.ruanyifeng.com/blog/2016/07/yaml.html" target="_blank" rel="noopener noreferrer">è¯­æ³•ä»‹ç»è¯·æˆ³<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>ä¸ jenkins å¯¹æ¯”</p> <ul><li>gitlab-ci çš„ä¼˜åŠ¿åœ¨äºæ¯”è¾ƒé…ç½®å’Œä½¿ç”¨ç®€å•ï¼Œèƒ½åœ¨ gitlab ä¸Šç›´æ¥çœ‹åˆ°æ‰§è¡Œè¿‡ç¨‹ï¼Œä¸éœ€è¦é… webhookï¼Œé›†æˆåœ¨äº† gitlab ä¸Šã€‚</li> <li>jenkins çš„ä¼˜åŠ¿åœ¨äºç¼–è¯‘æœåŠ¡å’Œä»£ç ä»“åº“åˆ†ç¦»ï¼Œè€Œä¸”ç¼–è¯‘é…ç½®æ–‡ä»¶ä¸éœ€è¦åœ¨å·¥ç¨‹ä¸­é…ç½®ï¼Œå¹¶ä¸” jenkins ä¾é å®ƒä¸°å¯Œçš„æ’ä»¶ï¼Œå¯ä»¥é…ç½®å¾ˆå¤š gitlab-ci ä¸å­˜åœ¨çš„åŠŸèƒ½ï¼Œæ¯”å¦‚è¯´çœ‹ç¼–è¯‘çŠ¶å†µç»Ÿè®¡ç­‰</li></ul> <h2 id="gitlab-runner"><a href="#gitlab-runner" class="header-anchor">#</a> gitlab-runner</h2> <ul><li>gitlab çš„è‡ªåŠ¨åŒ–æ“ä½œéƒ½æ˜¯åœ¨ runner æœºå™¨ä¸­è¿è¡Œ,æˆ‘ä»¬éœ€è¦æ³¨å†Œ runner</li> <li>runner åˆ†ä¸º shared runner å’Œ specified runner.</li></ul> <h3 id="gitlab-æ“ä½œ"><a href="#gitlab-æ“ä½œ" class="header-anchor">#</a> gitlab æ“ä½œ</h3> <p>gitlab ä¸Šæœ‰å…³ gitlab-ci çš„é…ç½®æœ‰ä¸¤å¤„</p> <ul><li>ä¸€å¤„æ˜¯ CI/CD å¯ä»¥æŸ¥çœ‹æ„å»ºä»»åŠ¡ pipelineã€job çš„æ‰§è¡Œæƒ…å†µ</li> <li>ä¸€å¤„æ˜¯ setting é‡Œé¢å¯¹ ci çš„è®¾ç½®</li></ul> <img src="https://i.loli.net/2020/12/12/IVjWRdYUlOKbCsn.png" alt="image-20201212122028807"> <ul><li><p>ä¸€æ¬¡æäº¤è§¦å‘ä¸€æ¬¡ CI&amp;CD å³æ‰§è¡Œä¸€æ¬¡è„šæœ¬å¯¹åº”ä¸€ä¸ª pipeline</p></li> <li><p>ä¸€ä¸ª pipeline å¯¹åº” stages ä¸‹çš„æ‰€æœ‰ job</p></li> <li><p>ä¸€ä¸ª stage å¯ä»¥æœ‰å¤šä¸ª jobï¼›</p></li></ul> <h3 id="skip-pipeline"><a href="#skip-pipeline" class="header-anchor">#</a> Skip Pipeline</h3> <ul><li>commit message ä¸ŠåŠ ä¸Š[ci skip]Â  æˆ–è€…[skip ci]å°±å¯ä»¥è·³è¿‡ pipeline æ‰§è¡Œã€‚</li> <li>åœ¨ä¸€æ¬¡ git push è°ƒç”¨ä¸­è¿›è¡Œå¤šæ¬¡æ›´æ”¹æ—¶ï¼ŒGitLab æœ€å¤šåˆ›å»ºå››ä¸ªåˆ†æ”¯å’Œæ ‡ç­¾ç®¡é“ã€‚æ­¤é™åˆ¶ä¸å½±å“ä»»ä½•æ›´æ–°çš„åˆå¹¶è¯·æ±‚ç®¡é“ã€‚æ‰€æœ‰æ›´æ–°çš„åˆå¹¶è¯·æ±‚åœ¨ä½¿ç”¨ç®¡é“å¤„ç†åˆå¹¶è¯·æ±‚æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªç®¡é“ã€‚</li></ul> <h2 id="stages"><a href="#stages" class="header-anchor">#</a> stages</h2> <ul><li><p>gitlab-ci çš„ pipeline ç”±ä¸€ä¸ªä¸ª stage é¡ºåºæ‰§è¡Œï¼Œæ¯ä¸ª stage å¯ä»¥æœ‰å¤šä¸ª job</p></li> <li><p>job æ˜¯å¹¶è¡Œæ‰§è¡Œçš„
æ‰€æœ‰ build çš„ jobs æ‰§è¡ŒæˆåŠŸåï¼Œcommit æ‰ä¼šæ ‡è®°ä¸º successï¼Œæ‰€æœ‰çš„ build çš„ jobs æ‰§è¡ŒæˆåŠŸï¼Œ</p></li> <li><p>ä»»ä½•ä¸€ä¸ªå‰ç½®çš„ jobs å¤±è´¥äº†ï¼Œcommit ä¼šæ ‡è®°ä¸º failed å¹¶ä¸”ä¸‹ä¸€ä¸ª stages çš„ jobs éƒ½ä¸ä¼šæ‰§è¡Œã€‚</p></li> <li><p>é»˜è®¤å®šä¹‰ä¸º buildï¼Œtest å’Œ deployã€‚</p></li> <li><p>å¦‚æœä¸€ä¸ª job æ²¡æœ‰æŒ‡å®š stageï¼Œé‚£ä¹ˆè¿™ä¸ªä»»åŠ¡ä¼šåˆ†é…åˆ° test stageã€‚</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token punctuation">-</span> <span class="token key atrule">stages</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> build
    <span class="token punctuation">-</span> release_deploy
    <span class="token punctuation">-</span> dev<span class="token punctuation">-</span>deploy
    <span class="token punctuation">-</span> prod_deploy
</code></pre></div></li></ul> <h3 id="jobs"><a href="#jobs" class="header-anchor">#</a> Jobs</h3> <ul><li>.gitlab-ci.yml å…è®¸æŒ‡å®šæ— é™é‡ jobsã€‚</li> <li>æ¯ä¸ª jobs å¿…é¡»æœ‰ä¸€ä¸ªå”¯ä¸€çš„åå­—ï¼Œè€Œä¸”ä¸èƒ½æ˜¯ä¸Šé¢æåˆ°çš„å…³é”®å­—ã€‚</li> <li>job ç”±ä¸€åˆ—å‚æ•°æ¥å®šä¹‰ jobs çš„è¡Œä¸ºã€‚</li> <li>æ‰€å±åŒä¸€ä¸ª stage çš„ job éƒ½æ˜¯å¹¶è¡Œçš„</li></ul> <div class="language- extra-class"><pre class="language-text"><code>job_name:
</code></pre></div><h3 id="pages"><a href="#pages" class="header-anchor">#</a> pages</h3> <p>ä¸€ä¸ªç‰¹æ®Šçš„ jobï¼Œç”¨äºä¸Šä¼ é™æ€å†…å®¹åˆ° GitLabï¼Œå¯ç”¨äºæœåŠ¡äºæ‚¨çš„ç½‘ç«™ã€‚éœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶</p> <ul><li>ä»»ä½•é™æ€å†…å®¹éƒ½å¿…é¡»æ”¾åœ¨<code>public/</code> directory. ç›®å½•</li> <li><code>artifacts</code> ï¼špath ï¼š<code>public/</code> ç›®å½•å¿…é¡»æœ‰</li></ul> <p>ä¸‹é¢çš„ç¤ºä¾‹åªæ˜¯å°†æ‰€æœ‰æ–‡ä»¶ä»é¡¹ç›®çš„æ ¹ç›®å½•ç§»åŠ¨åˆ° public/ç›®å½•</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">pages</span><span class="token punctuation">:</span>
  <span class="token key atrule">stage</span><span class="token punctuation">:</span> deploy
  <span class="token key atrule">script</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> mkdir .public
    <span class="token punctuation">-</span> cp <span class="token punctuation">-</span>r * .public
    <span class="token punctuation">-</span> mv .public public
  <span class="token key atrule">artifacts</span><span class="token punctuation">:</span> <span class="token comment"># å¿…é¡»æœ‰</span>
    <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> public
  <span class="token key atrule">only</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> master
</code></pre></div><h3 id="script"><a href="#script" class="header-anchor">#</a> script</h3> <div class="language- extra-class"><pre class="language-text"><code>script:
	- echo &quot;ğŸ“¦ å¼€å§‹æ‰“åŒ…&quot;
	- ssh xxx@xxxxxx &quot;
        rm -rf \`ls -d /xxx/www/* | grep -v -E '\.tar\.gz$'\` &amp;&amp;
        cd /xxx/www &amp;&amp;
        tar xvzf ${PKG_NAME} &amp;&amp;
        rm ${PKG_NAME}&quot;
     # é•¿å‘½ä»¤å¯ä»¥é€šè¿‡å¼•å·åŒ…è£¹ï¼Œå†ç”¨&amp;&amp;è¿æ¥è¡¨ç¤ºé¡ºåºæ‰§è¡Œå‘½ä»¤
</code></pre></div><h3 id="å˜é‡-variables"><a href="#å˜é‡-variables" class="header-anchor">#</a> å˜é‡ï¼švariables</h3> <p>å˜é‡å¯ä»¥è¢«è¦†ç›–ï¼Œå¹¶ä¸”æ˜¯æŒ‰ç…§ä»¥ä¸‹ä¼˜å…ˆçº§ä¾æ¬¡é™ä½</p> <ol><li><a href="https://docs.gitlab.com/ce/ci/triggers/README.html#making-use-of-trigger-variables" target="_blank" rel="noopener noreferrer">Trigger variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://docs.gitlab.com/ce/ci/pipelines/schedules.html#using-variables" target="_blank" rel="noopener noreferrer">scheduled pipeline variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, and <a href="https://docs.gitlab.com/ce/ci/variables/README.html#override-a-variable-by-manually-running-a-pipeline" target="_blank" rel="noopener noreferrer">manual pipeline run variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li>Project-level <a href="https://docs.gitlab.com/ce/ci/variables/README.html#custom-environment-variables" target="_blank" rel="noopener noreferrer">variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://docs.gitlab.com/ce/ci/variables/README.html#protect-a-custom-variable" target="_blank" rel="noopener noreferrer">protected variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. é¡¹ç›® CI è®¾ç½®çš„å˜é‡</li> <li>Group-level <a href="https://docs.gitlab.com/ce/ci/variables/README.html#group-level-environment-variables" target="_blank" rel="noopener noreferrer">variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://docs.gitlab.com/ce/ci/variables/README.html#protect-a-custom-variable" target="_blank" rel="noopener noreferrer">protected variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. gitlab åˆ†ç»„ä¸‹ CI è®¾ç½®çš„å˜é‡</li> <li>Instance-level <a href="https://docs.gitlab.com/ce/ci/variables/README.html#instance-level-cicd-environment-variables" target="_blank" rel="noopener noreferrer">variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://docs.gitlab.com/ce/ci/variables/README.html#protect-a-custom-variable" target="_blank" rel="noopener noreferrer">protected variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li><a href="https://docs.gitlab.com/ce/ci/variables/README.html#inherit-environment-variables" target="_blank" rel="noopener noreferrer">Inherited environment variables<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li><a href="https://docs.gitlab.com/ce/ci/yaml/README.html#job-variables" target="_blank" rel="noopener noreferrer">YAML å®šä¹‰çš„ job çº§åˆ«å˜é‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.gitlab.com/ce/ci/yaml/README.html#variables" target="_blank" rel="noopener noreferrer">YAML å®šä¹‰çš„å…¨å±€å˜é‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.gitlab.com/ce/ci/variables/README.html#deployment-variables" target="_blank" rel="noopener noreferrer">éƒ¨ç½²ç¯å¢ƒå˜é‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.gitlab.com/ce/ci/variables/README.html#predefined-variables-environment-variables" target="_blank" rel="noopener noreferrer">é¢„å®šä¹‰çš„ç¯å¢ƒå˜é‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (ä¼˜å…ˆçº§æœ€ä½)</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code>variables<span class="token operator">:</span>
  <span class="token constant">BUSINESS_LINE</span><span class="token operator">:</span> $<span class="token punctuation">{</span><span class="token constant">BUSINESS_LINE</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="job-çš„æ‰§è¡Œæ¡ä»¶"><a href="#job-çš„æ‰§è¡Œæ¡ä»¶" class="header-anchor">#</a> job çš„æ‰§è¡Œæ¡ä»¶</h3> <p>onlyï¼ˆå®šä¹‰ job æ‰§è¡Œæ¡ä»¶ï¼‰å’Œ exceptï¼ˆå®šä¹‰äº† job ä¸è¢«æ‰§è¡Œçš„æ¡ä»¶ï¼‰ä¸¤ä¸ªå‚æ•°å®šä¹‰äº† job è¢«åˆ›å»ºçš„æ¡ä»¶:</p> <ul><li><p>except å’Œ only å¦‚æœæ²¡æœ‰æŒ‡å®š nameï¼Œé»˜è®¤æ˜¯ tags å’Œ branches</p></li> <li><p>only å’Œ except å¦‚æœéƒ½å­˜åœ¨åœ¨ä¸€ä¸ª job å£°æ˜ä¸­ï¼Œåˆ™æ‰€éœ€å¼•ç”¨å°†ä¼šè¢« only å’Œ except æ‰€å®šä¹‰çš„åˆ†æ”¯è¿‡æ»¤.</p></li> <li><p>only å’Œ except å…è®¸ä½¿ç”¨æ­£åˆ™</p></li> <li><p>only å’Œ except å…è®¸ä½¿ç”¨æŒ‡å®šä»“åº“åœ°å€ï¼Œä½†æ˜¯ä¸ forks ä»“åº“</p></li></ul> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">only</span><span class="token punctuation">:</span> <span class="token comment">#éƒ½æ˜¯æˆ–è€…çš„å…³ç³»</span>
   <span class="token punctuation">-</span> tags      <span class="token comment"># tag åˆ†æ”¯ commit ä¹‹åè§¦å‘</span>
   <span class="token punctuation">-</span> triggers  <span class="token comment"># API è§¦å‘</span>
   <span class="token punctuation">-</span> <span class="token key atrule">branches</span><span class="token punctuation">:</span> <span class="token comment"># å½“ä½ çš„Git Refså¯¹åº”çš„æ˜¯ä¸€ä¸ªåˆ†æ”¯æ—¶è§¦å‘</span>
   <span class="token punctuation">-</span> tags      <span class="token comment"># å½“ä½ çš„Git Refså¯¹åº”çš„æ˜¯ä¸€ä¸ªæ ‡ç­¾æ—¶è§¦å‘</span>
   <span class="token punctuation">-</span> pushes    <span class="token comment"># å½“ä½ ä½¿ç”¨git pushæ—¶è§¦å‘</span>
   <span class="token punctuation">-</span> web       <span class="token comment"># å½“ä½ ä½¿ç”¨Webç•Œé¢çš„Run Pipelineæ—¶è§¦å‘</span>
   <span class="token punctuation">-</span> merge_requests <span class="token comment">#å½“ä½ åˆ›å»ºæˆ–è€…æ›´æ–°ä¸€ä¸ªmerge_requestsæ—¶è§¦å‘</span>
   <span class="token punctuation">-</span> schedules <span class="token comment"># æ¯æ—¥æ„å»ºè§¦å‘</span>
   <span class="token punctuation">-</span> /^issue<span class="token punctuation">-</span>.<span class="token important">*$/</span> <span class="token comment"># jobå°†ä¼šåªåœ¨issue-å¼€å¤´çš„refsä¸‹æ‰§è¡Œ</span>
   <span class="token punctuation">-</span> branches@gitlab<span class="token punctuation">-</span>org/gitlab<span class="token punctuation">-</span>ce  <span class="token comment">#åœ¨çˆ¶ä»“åº“gitlab-org/    gitlab-ceæœ‰æäº¤æ—¶è¿è¡Œã€‚</span>
<span class="token comment"># å¯¹åˆ†æ”¯çš„é™åˆ¶è§¦å‘,åªåœ¨åˆ†æ”¯æ˜¯masterå’Œschedulesçš„æ—¶å€™è§¦å‘</span>
    <span class="token key atrule">refs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> master
      <span class="token punctuation">-</span> schedules
    <span class="token key atrule">kubernetes</span><span class="token punctuation">:</span> active
<span class="token comment"># å˜é‡æ¡ä»¶è§¦å‘ï¼Œå½“RELEASEå˜é‡æ˜¯stagingæˆ–è€…STAGINGå­˜åœ¨æ—¶è§¦å‘</span>
    <span class="token key atrule">variables</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> $RELEASE == &quot;staging&quot;
      <span class="token punctuation">-</span> $STAGING
      <span class="token punctuation">-</span> ($CI_COMMIT_BRANCH == &quot;master&quot; <span class="token punctuation">|</span><span class="token punctuation">|</span> $CI_COMMIT_BRANCH == &quot;develop&quot;) <span class="token important">&amp;&amp;</span> $MY_VARIABLE
<span class="token comment"># æ–‡ä»¶å˜åŒ–æ‰è§¦å‘</span>
    <span class="token key atrule">changes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> Dockerfile
      <span class="token punctuation">-</span> docker/scripts/*
      <span class="token punctuation">-</span> dockerfiles/<span class="token important">**/*</span>
      <span class="token punctuation">-</span> more_scripts/<span class="token important">*.</span><span class="token punctuation">{</span>rb<span class="token punctuation">,</span>py<span class="token punctuation">,</span>sh<span class="token punctuation">}</span>
<span class="token key atrule">rules</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span> <span class="token string">'$CI_PIPELINE_SOURCE == &quot;merge_request_event&quot;'</span>
      <span class="token key atrule">when</span><span class="token punctuation">:</span> manual
      <span class="token key atrule">allow_failure</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span> <span class="token string">'$CI_PIPELINE_SOURCE == &quot;schedule&quot;'</span>
    <span class="token punctuation">-</span> <span class="token key atrule">if</span><span class="token punctuation">:</span> ($CI_COMMIT_BRANCH == &quot;master&quot; <span class="token punctuation">|</span><span class="token punctuation">|</span> $CI_COMMIT_BRANCH == &quot;develop&quot;) <span class="token important">&amp;&amp;</span> $MY_VARIABLE
</code></pre></div><p><img src="https://i.loli.net/2020/12/13/TKO5iznorx2Vv46.png" alt="image-20201213200855935"></p> <h3 id="image-services"><a href="#image-services" class="header-anchor">#</a> image/services</h3> <p>è¯¥å…³é”®å­—æŒ‡å®šä¸€ä¸ªä»»åŠ¡ï¼ˆjobï¼‰æ‰€ä½¿ç”¨çš„ docker é•œåƒï¼Œä¾‹å¦‚<code>image: python:latest</code>ä½¿ç”¨ Python çš„æœ€æ–°é•œåƒã€‚</p> <p>é•œåƒä¸‹è½½çš„ç­–ç•¥ï¼š</p> <ul><li>neverï¼š å½“ä½¿ç”¨è¿™ä¸ªç­–ç•¥ï¼Œä¼šç¦æ­¢ Gitlab Runner ä» Docker hub æˆ–è€…å…¶ä»–åœ°æ–¹ä¸‹æ‹‰é•œåƒï¼Œåªèƒ½ä½¿ç”¨è‡ªå·±æ‰‹åŠ¨ä¸‹æ‹‰çš„é•œåƒ</li> <li>if-not-presentï¼š å½“ä½¿ç”¨è¿™ä¸ªç­–ç•¥ï¼ŒRunner ä¼šå…ˆæ£€æµ‹æœ¬åœ°æ˜¯å¦æœ‰é•œåƒï¼Œæœ‰çš„è¯ä½¿ç”¨è¯¥é•œåƒï¼Œå¦‚æœæ²¡æœ‰å†å»ä¸‹æ‹‰ã€‚è¿™ä¸ªç­–ç•¥å¦‚æœå†é…åˆå®šæœŸåˆ é™¤é•œåƒï¼Œå°±èƒ½è¾¾åˆ°æ¯”è¾ƒå¥½çš„æ•ˆæœã€‚</li> <li>alwaysï¼š è¿™ä¸ªæ˜¯ gitlab-ci é»˜è®¤ä½¿ç”¨çš„ç­–ç•¥ï¼Œå³æ¯ä¸€æ¬¡éƒ½æ˜¯é‡æ–°ä¸‹æ‹‰é•œåƒï¼Œå¯¼è‡´çš„ç»“æœå°±æ˜¯æ¯”è¾ƒè€—æ—¶é—´</li></ul> <h3 id="artifacts"><a href="#artifacts" class="header-anchor">#</a> artifacts</h3> <p>artifacts è¢«ç”¨äºåœ¨ job ä½œä¸šæˆåŠŸåå°†åˆ¶å®šåˆ—è¡¨é‡Œçš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹é™„åŠ åˆ° job ä¸Šï¼Œä¼ é€’ç»™ä¸‹ä¸€ä¸ª job ï¼Œå¦‚æœè¦åœ¨ä¸¤ä¸ª job ä¹‹é—´ä¼ é€’ artifactsï¼Œä½ å¿…é¡»è®¾ç½® dependencies,ä¸‹é¢æœ‰å‡ ä¸ªä¾‹å­</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">artifacts</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;$CI_JOB_NAME&quot;</span> <span class="token comment"># artifactså‹ç¼©åŒ…é‡å‘½å</span>
  <span class="token key atrule">untracked</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># ä¼ é€’æ‰€æœ‰gitæ²¡æœ‰è¿½è¸ªçš„æ–‡ä»¶</span>
  <span class="token key atrule">when</span><span class="token punctuation">:</span> on_failure <span class="token comment"># å½“jobæ‰§è¡Œå¤±è´¥æ—¶ï¼Œä¸Šä¼ artifacts,è¿˜æœ‰on_success è¿™ä¸ªå€¼æ˜¯é»˜è®¤çš„ï¼Œå½“jobæˆåŠŸæ—¶ä¸Šä¼ artifactsã€‚always ä¸ç®¡å¤±è´¥ä¸å¦ï¼Œéƒ½ä¸Šä¼ </span>
  <span class="token key atrule">artifacts</span><span class="token punctuation">:</span> expire_in <span class="token comment"># è®¾ç½® artifacts ä¸Šä¼ åŒ…çš„å¤±æ•ˆæ—¶é—´. å¦‚æœä¸è®¾ç½®ï¼Œartifacts çš„æ‰“åŒ…æ˜¯æ°¸è¿œå­˜åœ¨äº gitlabä¸Š çš„ï¼Œ'3 mins 4 sec','2 hrs 20 min','2h20min','6 mos 1 day','47 yrs 6 mos and 4d','3 weeks and 2 days'</span>
  <span class="token key atrule">paths</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> binaries/ <span class="token comment">#ä¼ é€’æ‰€æœ‰binarieså’Œ.configï¼š</span>
    <span class="token punctuation">-</span> .config
</code></pre></div><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="header-anchor">#</a> å‚è€ƒ</h2> <p><a href="https://juejin.cn/post/6844904045581172744#heading-11" target="_blank" rel="noopener noreferrer">Gitlab-CI ä½¿ç”¨æ•™ç¨‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://docs.gitlab.com/ee/ci/README.html" target="_blank" rel="noopener noreferrer">Gitlab-ci-å®˜æ–¹æ–‡æ¡£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/vuejs/vuepress/edit/master/dev-ops/gitlab ci.md" target="_blank" rel="noopener noreferrer">å¸®åŠ©æˆ‘ä»¬æ”¹å–„æ­¤é¡µé¢ï¼</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/30/2023, 7:22:50 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/dev-ops/docker.html" class="prev">
        Docker
      </a></span> <span class="next"><a href="/dev-ops/gitlab-ciè¸©å‘.html">
        Gitlab-ci è¸©å‘
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.301264ef.js" defer></script><script src="/assets/js/2.491aa157.js" defer></script><script src="/assets/js/33.3096cd30.js" defer></script>
  </body>
</html>
